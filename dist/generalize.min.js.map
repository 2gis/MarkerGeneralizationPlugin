{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///generalize.min.js","webpack:///webpack/bootstrap 401fa145d0d40168bb7e","webpack:///./src/index.js","webpack:///./src/ExtendedMarker.js","webpack:///./src/MarkerClassList.js","webpack:///./src/Generalize.js","webpack:///./node_modules/@2gis/general/dist/general.js","webpack:///(webpack)/buildin/module.js","webpack:///./node_modules/deep-clone/index.js","webpack:///./node_modules/deep-clone/lib/index.js"],"names":["root","factory","exports","module","define","amd","self","this","modules","__webpack_require__","moduleId","installedModules","i","l","call","m","c","d","name","getter","o","Object","defineProperty","configurable","enumerable","get","n","__esModule","object","property","prototype","hasOwnProperty","p","s","_interopRequireDefault","obj","default","extendLeaflet","L","markerEx","latlng","options","_ExtendedMarker2","markerGeneralizeGroup","option","_Generalize2","value","_ExtendedMarker","_Generalize","_MarkerClassList","Marker","extend","_extended","onAdd","apply","arguments","_immunityLevel","IMMUNITY","NO_DELETE","_icon","style","display","classes","_addClasses","getEvents","_zoomAnimated","onBeforeRemove","NO_HIDE","initialize","markerClassList","NONE","immunifyForDeletion","immunifyForHide","revokeImmunity","MarkerClassList","marker","_classList","_marker","Util","add","className","DomUtil","addClass","remove","removeClass","contains","clear","toString","keys","join","classList","isEmpty","prop","_general","_deepClone","_deepClone2","FeatureGroup","levels","margin","safeZone","size","offset","bufferPart","checkMarkerMinimumLevel","pane","setOptions","_generalizer","General","_layers","_priorityMarkers","_otherMarkers","setMaxZoom","maxZoom","setMinZoom","minZoom","_initZooms","isNaN","_maxZoom","_getMaxZoom","Error","_minZoom","_map","getMaxZoom","_getMinZoom","getMinZoom","_zoomStat","ready","pending","markers","bounds","minX","minY","maxX","maxY","_flushMarkersCache","_getLevels","zoom","ops","_prepareLevels","dpr","window","devicePixelRatio","levelId","length","level","index","degradation","_addLayer","layer","addEventParent","showAlways","push","oldMap","LayerGroup","addLayer","_getMapCenter","centerPoint","_getCenterLayerPoint","projectedPoint","getPixelOrigin","unproject","_getScreenBounds","center","topLeftPoint","_getTopLeftPoint","getSize","x","y","_getBounds","screenBounds","_getLatLngBounds","pointBound","pixelBound","Bounds","point","swCoord","getBottomLeft","neCoord","getTopRight","LatLngBounds","_prepareMarker","classForZoom","_prepareMarkersForGeneralization","pixelPosition","project","_latlng","Array","newMarker","groupIndex","iconIndex","_calculateMarkersClassesIfNeeded","undefined","getZoom","_calculateMarkersClasses","calculatedBounds","newBounds","newLatLngBounds","_invalidateMarkers","_this","priorityGroups","map","atlasSpritesEmulation","anchor","generalize","then","catch","fireEvent","groupClass","markerState","state","removeLayer","getPane","_zoomStart","getBounds","addLayers","layersArray","eachLayer","setTimeout","bind","_removeLayer","beforeLength","indexOf","splice","_this2","zoomstart","zoomend","moveend","getLayers","onRemove","clearLayers","__WEBPACK_AMD_DEFINE_FACTORY__","__WEBPACK_AMD_DEFINE_ARRAY__","__WEBPACK_AMD_DEFINE_RESULT__","_typeof","Symbol","iterator","constructor","r","e","t","a","u","prevGroupIndex","pixelPositionX","pixelPositionY","NaN","b","worker","queue","currentJob","markerArray","Float32Array","onmessage","resolve","data","dequeue","sprites","Promise","message","pack","shift","markerCount","postMessage","buffer","oe","console","error","ENTRY_MODULE","replace","match","RegExp","exec","pop","concat","all","JSON","stringify","Blob","type","bare","URL","webkitURL","mozURL","msURL","f","createObjectURL","Worker","objectURL","v","h","g","Uint8Array","w","k","Y","I","X","j","O","P","G","A","U","_","R","J","M","N","webpackPolyfill","deprecate","paths","children","deepClone","format","refs","Map","cloned","isArray","_clone","set","Date","valueOf","clone","_i","formatKeys"],"mappings":"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","file":"generalize.min.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MarkerGeneralizationPlugin\"] = factory();\n\telse\n\t\troot[\"MarkerGeneralizationPlugin\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn \n\n\n// WEBPACK FOOTER //\n// webpack/universalModuleDefinition","(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory();\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"MarkerGeneralizationPlugin\"] = factory();\n\telse\n\t\troot[\"MarkerGeneralizationPlugin\"] = factory();\n})(typeof self !== 'undefined' ? self : this, function() {\nreturn /******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId]) {\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/ \t\t}\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\ti: moduleId,\n/******/ \t\t\tl: false,\n/******/ \t\t\texports: {}\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.l = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// define getter function for harmony exports\n/******/ \t__webpack_require__.d = function(exports, name, getter) {\n/******/ \t\tif(!__webpack_require__.o(exports, name)) {\n/******/ \t\t\tObject.defineProperty(exports, name, {\n/******/ \t\t\t\tconfigurable: false,\n/******/ \t\t\t\tenumerable: true,\n/******/ \t\t\t\tget: getter\n/******/ \t\t\t});\n/******/ \t\t}\n/******/ \t};\n/******/\n/******/ \t// getDefaultExport function for compatibility with non-harmony modules\n/******/ \t__webpack_require__.n = function(module) {\n/******/ \t\tvar getter = module && module.__esModule ?\n/******/ \t\t\tfunction getDefault() { return module['default']; } :\n/******/ \t\t\tfunction getModuleExports() { return module; };\n/******/ \t\t__webpack_require__.d(getter, 'a', getter);\n/******/ \t\treturn getter;\n/******/ \t};\n/******/\n/******/ \t// Object.prototype.hasOwnProperty.call\n/******/ \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"/dist/\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(__webpack_require__.s = 0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\nexports.default = extendLeaflet;\n\nvar _ExtendedMarker = __webpack_require__(1);\n\nvar _ExtendedMarker2 = _interopRequireDefault(_ExtendedMarker);\n\nvar _Generalize = __webpack_require__(3);\n\nvar _Generalize2 = _interopRequireDefault(_Generalize);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nfunction extendLeaflet() {\n    L.markerEx = function (latlng, options) {\n        return new _ExtendedMarker2.default(latlng, options);\n    };\n\n    L.markerGeneralizeGroup = function (option) {\n        return new _Generalize2.default(option);\n    };\n} // Какого чОрта? @todo Вытащить в online, тут это не нужно\n\n/***/ }),\n/* 1 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _MarkerClassList = __webpack_require__(2);\n\nvar _MarkerClassList2 = _interopRequireDefault(_MarkerClassList);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\n// eslint-disable-line no-unused-vars\n\n/**\n * Extended marker:\n * - has options to prevent deletion or hide during generalization\n * - makes use of internal class list being applied to icon node\n */\nexports.default = L.Marker.extend({\n    /**\n     * If we can use extended powers of current marker.\n     */\n    _extended: true,\n\n    /**\n     * Augment parent method to apply class names when icon is added on map\n     */\n    onAdd: function onAdd() {\n        L.Marker.prototype.onAdd.apply(this, arguments);\n\n        if (this._immunityLevel == this.IMMUNITY.NO_DELETE) {\n            this._icon.style.display = 'block';\n        }\n\n        this.classes._addClasses();\n    },\n\n    getEvents: function getEvents() {\n        this._zoomAnimated = false;\n        return L.Marker.prototype.getEvents.apply(this, arguments);\n    },\n\n    /**\n     * Determine removal possibility and hide marker if required.\n     * @returns {boolean} If marker should be removed from map\n     */\n    onBeforeRemove: function onBeforeRemove() {\n        if (this._immunityLevel == this.IMMUNITY.NO_HIDE) {\n            return false;\n        }\n\n        if (this._immunityLevel == this.IMMUNITY.NO_DELETE) {\n            this._icon.style.display = 'none';\n            return false;\n        }\n\n        return true;\n    },\n\n    initialize: function initialize() {\n        L.Marker.prototype.initialize.apply(this, arguments);\n        this.classes = L.markerClassList(this);\n    },\n\n    /**\n     * Marker immunity mechanism\n     */\n    IMMUNITY: {\n        NONE: 0, // Simple marker\n        NO_DELETE: 1, // Will stay on map during generalization (DOM node of the icon will not be deleted).\n        NO_HIDE: 2 // Will not be neither deleted nor hidden during generalization.\n    },\n    _immunityLevel: null,\n    immunifyForDeletion: function immunifyForDeletion() {\n        this._immunityLevel = this.IMMUNITY.NO_DELETE;\n        return this;\n    },\n    immunifyForHide: function immunifyForHide() {\n        this._immunityLevel = this.IMMUNITY.NO_HIDE;\n        return this;\n    },\n    revokeImmunity: function revokeImmunity() {\n        this._immunityLevel = this.IMMUNITY.NONE;\n        return this;\n    }\n});\n\n/***/ }),\n/* 2 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n/**\n * Icon internal classes mechanism\n * Adds possibility to assign css classes to icon even if it is not rendered (yet).\n * Classes will be assigned to icon when it is rendered.\n */\nL.MarkerClassList = function (marker) {\n    this._classList = {};\n    this._marker = marker;\n};\n\nL.Util.extend(L.MarkerClassList.prototype, {\n    add: function add(className) {\n        this._classList[className] = 1;\n        if (this._marker._icon) {\n            L.DomUtil.addClass(this._marker._icon, className);\n        }\n        return this;\n    },\n    remove: function remove(className) {\n        delete this._classList[className];\n        if (this._marker._icon) {\n            L.DomUtil.removeClass(this._marker._icon, className);\n        }\n        return this;\n    },\n    contains: function contains(className) {\n        return !!this._classList[className];\n    },\n    clear: function clear() {\n        if (this._marker._icon) {\n            for (var className in this._classList) {\n                // eslint-disable-line guard-for-in\n                L.DomUtil.removeClass(this._marker._icon, className);\n            }\n        }\n        this._classList = {};\n    },\n    toString: function toString() {\n        if (Object.keys) {\n            return Object.keys(this._classList).join(' ');\n        }\n        var classList = '';\n        for (var i in this._classList) {\n            // eslint-disable-line guard-for-in\n            classList += i + ' ';\n        }\n        return classList;\n    },\n    _addClasses: function _addClasses() {\n        if (!this._marker._icon) {\n            return;\n        }\n        for (var className in this._classList) {\n            // eslint-disable-line guard-for-in\n            L.DomUtil.addClass(this._marker._icon, className);\n        }\n    }\n});\n\nL.markerClassList = function (marker) {\n    return new L.MarkerClassList(marker);\n};\n\nexports.default = L.MarkerClassList;\n\n/***/ }),\n/* 3 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n    value: true\n});\n\nvar _general = __webpack_require__(4);\n\nvar _deepClone = __webpack_require__(6);\n\nvar _deepClone2 = _interopRequireDefault(_deepClone);\n\nfunction _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }\n\nexports.default = L.FeatureGroup.extend({\n    options: {\n        levels: [{\n            margin: 30,\n            safeZone: 20,\n            size: [25, 40],\n            offset: [0.5, 1],\n            className: '_pin'\n        }, {\n            safeZone: 5,\n            size: [6, 6],\n            className: '_bullet'\n        }, {\n            safeZone: 0,\n            className: '_hidden'\n        }],\n\n        bufferPart: 0.5,\n\n        checkMarkerMinimumLevel: function checkMarkerMinimumLevel() {\n            return 0;\n        },\n\n        // by default Layer has overlayPane, but we work with markers\n        pane: 'markerPane'\n    },\n\n    initialize: function initialize(options) {\n        L.Util.setOptions(this, options);\n\n        this._generalizer = new _general.General();\n\n        this._layers = {};\n\n        this._priorityMarkers = [];\n        this._otherMarkers = [];\n\n        this.setMaxZoom(options.maxZoom);\n        this.setMinZoom(options.minZoom);\n\n        this._initZooms(); // Обязательно после set[Min|Max]Zoom\n    },\n\n    setMaxZoom: function setMaxZoom(maxZoom) {\n        if (!isNaN(maxZoom) && maxZoom <= 19) {\n            this._maxZoom = maxZoom;\n        }\n    },\n\n    setMinZoom: function setMinZoom(minZoom) {\n        if (!isNaN(minZoom) && minZoom >= 0) {\n            if (minZoom > this._getMaxZoom()) {\n                throw new Error('Min zoom must be smaller than max zoom');\n            }\n            this._minZoom = minZoom;\n        }\n    },\n\n    _getMaxZoom: function _getMaxZoom() {\n        if (!isNaN(this._maxZoom)) {\n            return this._maxZoom;\n        }\n        if (this._map) {\n            return this._map.getMaxZoom();\n        }\n        return 18;\n    },\n\n    _getMinZoom: function _getMinZoom() {\n        if (!isNaN(this._minZoom)) {\n            return this._minZoom;\n        }\n        if (this._map) {\n            return this._map.getMinZoom();\n        }\n        return 0;\n    },\n\n    _initZooms: function _initZooms() {\n        this._zoomStat = {};\n        var maxZoom = this._getMaxZoom();\n        for (var i = this._getMinZoom(); i <= maxZoom; ++i) {\n            this._zoomStat[i] = {\n                ready: false,\n                pending: false,\n                markers: null,\n                bounds: { minX: 0, minY: 0, maxX: 0, maxY: 0 }\n            };\n        }\n    },\n\n    _flushMarkersCache: function _flushMarkersCache() {\n        var maxZoom = this._getMaxZoom();\n        for (var i = this._getMinZoom(); i <= maxZoom; ++i) {\n            this._zoomStat[i].markers = null;\n        }\n    },\n\n\n    _getLevels: function _getLevels(zoom) {\n        var ops = this.options;\n\n        var levels;\n        if (typeof ops.levels === 'function') {\n            levels = ops.levels(this._map, zoom);\n        } else {\n            levels = ops.levels;\n        }\n        return this._prepareLevels((0, _deepClone2.default)(levels));\n    },\n\n    _prepareLevels: function _prepareLevels(levels) {\n        var dpr = window.devicePixelRatio;\n        for (var levelId = 0; levelId < levels.length; levelId++) {\n            var level = levels[levelId];\n            level.index = levelId;\n\n            if (!level.size) {\n                level.size = [0, 0];\n            }\n            level.size[0] *= dpr;\n            level.size[1] *= dpr;\n\n            if (!level.offset) {\n                level.offset = [0.5, 0.5];\n            }\n\n            if (!level.margin) {\n                level.margin = 0;\n            }\n            level.margin *= dpr;\n\n            if (!level.safeZone) {\n                level.safeZone = 0;\n            }\n            level.safeZone *= dpr;\n\n            if (!level.degradation) {\n                level.degradation = 0;\n            }\n            level.degradation *= dpr;\n        }\n        return levels;\n    },\n\n    _addLayer: function _addLayer(layer) {\n        layer.addEventParent(this);\n\n        if (layer.options && layer.options.showAlways) {\n            this._priorityMarkers.push(layer);\n        } else {\n            this._otherMarkers.push(layer);\n        }\n\n        var oldMap = this._map;\n\n        // Don't allow markers to be added to map: we'll do it during invalidation.\n        if (oldMap) {\n            this._map = null;\n        }\n        L.LayerGroup.prototype.addLayer.call(this, layer);\n        if (oldMap) {\n            this._map = oldMap;\n        }\n    },\n\n    /**\n     * Возвращает географические координаты центра карты на заданном зуме\n     * @param  {Number} zoom\n     * @return {L.LatLng}    Географический центр карты\n     */\n    _getMapCenter: function _getMapCenter(zoom) {\n        var centerPoint = this._map._getCenterLayerPoint();\n        // @TODO getPixelOrigin должен зависить от зума, тут скрыт потенциальный баг\n        var projectedPoint = centerPoint.add(this._map.getPixelOrigin());\n        return this._map.unproject(projectedPoint, zoom);\n    },\n\n\n    /**\n     * Возвращает размеры экрана\n     */\n    _getScreenBounds: function _getScreenBounds(center, zoom) {\n        if (!this._map) {\n            return { minX: 0, minY: 0, maxX: 0, maxY: 0 };\n        }\n        var dpr = window.devicePixelRatio;\n        var topLeftPoint = this._map._getTopLeftPoint(center, zoom);\n        var size = this._map.getSize();\n        return {\n            minX: topLeftPoint.x * dpr,\n            minY: topLeftPoint.y * dpr,\n            maxX: (topLeftPoint.x + size.x) * dpr,\n            maxY: (topLeftPoint.y + size.y) * dpr\n        };\n    },\n\n\n    /**\n     * Возвращает размеры экрана с некоторым буффером вокруг\n     */\n    _getBounds: function _getBounds(center, zoom) {\n        var screenBounds = this._getScreenBounds(center, zoom);\n        return {\n            minX: screenBounds.minX - (screenBounds.maxX - screenBounds.minX) * this.options.bufferPart,\n            minY: screenBounds.minY - (screenBounds.maxY - screenBounds.minY) * this.options.bufferPart,\n            maxX: screenBounds.maxX + (screenBounds.maxX - screenBounds.minX) * this.options.bufferPart,\n            maxY: screenBounds.maxY + (screenBounds.maxY - screenBounds.minY) * this.options.bufferPart\n        };\n    },\n\n    _getLatLngBounds: function _getLatLngBounds(pointBound, center, zoom) {\n        var pixelBound = new L.Bounds(L.point(pointBound.minX, pointBound.minY), L.point(pointBound.maxX, pointBound.maxY));\n        var swCoord = this._map.unproject(pixelBound.getBottomLeft(), zoom);\n        var neCoord = this._map.unproject(pixelBound.getTopRight(), zoom);\n        return new L.LatLngBounds(swCoord, neCoord);\n    },\n\n    _prepareMarker: function _prepareMarker(layer) {\n        var minZoom = this._getMinZoom();\n        for (var zoom = this._getMaxZoom(); zoom >= minZoom; --zoom) {\n            layer.options.classForZoom = layer.options.classForZoom || [];\n            layer.options.classForZoom[zoom] = 'HIDDEN';\n        }\n    },\n\n    _prepareMarkersForGeneralization: function _prepareMarkersForGeneralization(zoom) {\n        var dpr = window.devicePixelRatio;\n        if (this._zoomStat[zoom].markers) {\n            for (var i = 0; i < this._zoomStat[zoom].markers.length; ++i) {\n                var pixelPosition = this._map.project(this._zoomStat[zoom].markers[i]._latlng, zoom);\n                this._zoomStat[zoom].markers[i].pixelPosition = [pixelPosition.x * dpr, pixelPosition.y * dpr];\n            }\n            return this._zoomStat[zoom].markers;\n        }\n\n        var markers = new Array(this._otherMarkers.length);\n\n        for (var _i = 0; _i < this._otherMarkers.length; ++_i) {\n            var _pixelPosition = this._map.project(this._otherMarkers[_i]._latlng, zoom);\n            var newMarker = {\n                _latlng: this._otherMarkers[_i]._latlng,\n                groupIndex: this.options.checkMarkerMinimumLevel(this._otherMarkers[_i]),\n                iconIndex: -1,\n                pixelPosition: [_pixelPosition.x * dpr, _pixelPosition.y * dpr]\n            };\n            markers[_i] = newMarker;\n        }\n\n        return markers;\n    },\n\n    _calculateMarkersClassesIfNeeded: function _calculateMarkersClassesIfNeeded() {\n        var zoom = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._map.getZoom();\n\n        /**\n         * Возможны следующие варианты\n         * 1. Изменился zoom карты\n         * 1.1 Смотрим, для каких границ был произведена генерализация на этом зуме\n         * 1.2 Если попадаем в рамки границ, для которых уже произведена генерализация, то ничего не делаем\n         * 1.3 Если не попадаем - запускаем генерализацию\n         * 2. Изменился центр карты => изменились границы\n         * 2.1 Делаем шаги, аналогичные 1.1 - 1.3.\n         *\n         * Становится очевидно, что генерализацию нужно перезапускать\n         * только когда не попали в ранее посчитанные границы на заданном зуме.\n         */\n        if (!this._map) {\n            return;\n        }\n\n        if (!this._zoomStat[zoom].ready && !this._zoomStat[zoom].pending) {\n            this._calculateMarkersClasses(zoom);\n            return;\n        }\n\n        var center = this._getMapCenter();\n\n        var calculatedBounds = this._zoomStat[zoom].bounds; // Это \"старые\" границы, которые были генерализированы\n        var newBounds = this._getScreenBounds(center, zoom); // Именно размеры экрана без буффера\n        var newLatLngBounds = this._getLatLngBounds( // Это \"новые\" границы, которы должны быть перекрыты \"старыми\"\n        newBounds, center, zoom);\n\n        if (!calculatedBounds.contains(newLatLngBounds)) {\n            // Собственно, описанная выше проверка перекрытия границ\n            this._calculateMarkersClasses(zoom);\n            return;\n        }\n\n        // Если дошли сюда, это значит, что для заданного зума в рамках текущего баунда генерализация уже произведена.\n        this._invalidateMarkers();\n    },\n\n    _calculateMarkersClasses: function _calculateMarkersClasses() {\n        var _this = this;\n\n        var zoom = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : this._map.getZoom();\n\n        if (!this._map) {\n            // Если нет карты, то ничего полезного сделать мы не можем\n            return undefined;\n        }\n        if (isEmpty(this._layers)) {\n            // Ничего не надо генерализовывать если маркеров нет\n            return undefined;\n        }\n        var levels = this._getLevels(zoom);\n        var center = this._getMapCenter();\n\n        // Набор конфигов для генерализации маркеров\n        var bounds = this._getBounds(center, zoom);\n        var priorityGroups = levels.map(function (level) {\n            return {\n                iconIndex: level.index,\n                safeZone: level.safeZone,\n                margin: level.margin,\n                degradation: level.degradation\n            };\n        });\n        var atlasSpritesEmulation = levels.map(function (level) {\n            return {\n                size: level.size, // Размер иконки\n                anchor: level.offset // Центр иконки относительно ее размеров, принимает занчения от 0 до 1\n            };\n        });\n\n        // Переводим маркеры в нужный формат\n        var markers = this._prepareMarkersForGeneralization(zoom);\n\n        this._zoomStat[zoom] = {\n            ready: false,\n            pending: true,\n            bounds: this._getLatLngBounds(bounds, center, zoom),\n            markers: markers\n        };\n\n        // Запускаем генерализацию\n        return this._generalizer.generalize(bounds, priorityGroups, atlasSpritesEmulation, markers).then(function () {\n            // Выставляем классы для генерализованных маркеров\n            for (var i = 0; i < markers.length; ++i) {\n                var marker = _this._otherMarkers[i];\n                var iconIndex = markers[i].iconIndex;\n                marker.options.classForZoom[zoom] = iconIndex == -1 ? 'HIDDEN' : levels[iconIndex].className;\n            }\n\n            // Подбиваем маркера, которые не учавстовали в генерализации\n            for (var _i2 = 0; _i2 < _this._priorityMarkers.length; ++_i2) {\n                var _marker = _this._priorityMarkers[_i2];\n                var _iconIndex = _this.options.checkMarkerMinimumLevel(_marker);\n                _marker.options.classForZoom[zoom] = _iconIndex == -1 ? 'HIDDEN' : levels[_iconIndex].className;\n            }\n\n            _this._zoomStat[zoom].ready = true;\n            _this._zoomStat[zoom].pending = false;\n            if (_this._map.getZoom() == zoom) {\n                _this._invalidateMarkers();\n            }\n        }).catch(function () {\n            _this.fireEvent('generalizationError');\n        });\n    },\n\n    _invalidateMarkers: function _invalidateMarkers() {\n        var zoom = this._map.getZoom();\n\n        if (!this._zoomStat[zoom].ready) {\n            return;\n        }\n\n        for (var i in this._layers) {\n            // eslint-disable-line guard-for-in\n            var marker = this._layers[i];\n            var groupClass = marker.options.classForZoom[zoom];\n            var markerState = marker.options.state;\n\n            if (marker._immunityLevel) {\n                if (!marker._map) {\n                    this._map.addLayer(marker);\n                }\n\n                if (markerState != groupClass && groupClass != 'HIDDEN') {\n                    L.DomUtil.addClass(marker._icon, groupClass);\n                }\n            }\n\n            if (groupClass != 'HIDDEN' && markerState != groupClass) {\n                if (!marker._map) {\n                    this._map.addLayer(marker);\n                }\n\n                if (markerState != groupClass) {\n                    if (markerState && markerState != 'HIDDEN') {\n                        L.DomUtil.removeClass(marker._icon, markerState);\n                    }\n                    L.DomUtil.addClass(marker._icon, groupClass);\n                }\n            }\n\n            if (groupClass == 'HIDDEN') {\n                var shouldRemove = marker.onBeforeRemove ? marker.onBeforeRemove() : true;\n                if (shouldRemove) {\n                    this._map.removeLayer(marker);\n                }\n            }\n            marker.options.state = groupClass;\n        }\n\n        if (!isEmpty(this._layers)) {\n            this.getPane().style.display = 'block';\n        }\n        this.fireEvent('invalidationFinish');\n    },\n\n    _zoomStart: function _zoomStart() {\n        this._zoomStat[this._map.getZoom()] = {\n            ready: false,\n            pending: false,\n            bounds: this._map.getBounds(),\n            markers: null\n        };\n        if (!isEmpty(this._layers)) {\n            this.getPane().style.display = 'none';\n        }\n    },\n\n    addLayer: function addLayer(layer) {\n        this._addLayer(layer);\n        if (this._map && !layer._immunityLevel) {\n            this._flushMarkersCache();\n            this._prepareMarker(layer);\n            this._calculateMarkersClasses();\n            this._invalidateMarkers();\n        }\n        return this;\n    },\n\n    addLayers: function addLayers(layersArray) {\n        var i;\n        for (i = 0; i < layersArray.length; i++) {\n            this._addLayer(layersArray[i]);\n        }\n\n        if (this._map) {\n            this._flushMarkersCache();\n            this.eachLayer(this._prepareMarker, this);\n            setTimeout(this._calculateMarkersClasses.bind(this), 0);\n        }\n        return this;\n    },\n\n    _removeLayer: function _removeLayer(layer) {\n        var beforeLength = this._layers.length;\n        var index;\n        if ((index = this._priorityMarkers.indexOf(layer)) != -1) {\n            this._priorityMarkers.splice(index, 1);\n        } else if ((index = this._otherMarkers.indexOf(layer)) != -1) {\n            this._otherMarkers.splice(index, 1);\n        }\n        L.LayerGroup.prototype.removeLayer.call(this, layer);\n        return beforeLength - this._layers.length != 0;\n    },\n\n    removeLayer: function removeLayer(layer) {\n        if (this._removeLayer(layer)) {\n            this._flushMarkersCache();\n            this._calculateMarkersClasses();\n            this._invalidateMarkers();\n        }\n\n        return this;\n    },\n\n    getEvents: function getEvents() {\n        var _this2 = this;\n\n        var events = {\n            zoomstart: this._zoomStart,\n            zoomend: function zoomend() {\n                return _this2._calculateMarkersClassesIfNeeded();\n            },\n            moveend: function moveend() {\n                return _this2._calculateMarkersClassesIfNeeded();\n            }\n        };\n\n        return events;\n    },\n\n    onAdd: function onAdd(map) {\n        this._map = map;\n\n        this._initZooms();\n\n        if (this.getLayers().length) {\n\n            this.eachLayer(this._prepareMarker, this);\n            // wait user map manipulation to know correct init zoom\n            setTimeout(this._calculateMarkersClasses.bind(this), 0);\n        }\n    },\n\n    onRemove: function onRemove(map) {\n        if (!this._map) {\n            return;\n        }\n\n        L.LayerGroup.prototype.onRemove.call(this, map);\n\n        for (var i in this._layers) {\n            // eslint-disable-line guard-for-in\n            var marker = this._layers[i];\n            marker.options.state = 'HIDDEN';\n        }\n\n        this._flushMarkersCache();\n        this._map = null;\n    },\n\n    clearLayers: function clearLayers() {\n        for (var i in this._layers) {\n            // eslint-disable-line guard-for-in\n            L.LayerGroup.prototype.removeLayer.call(this, this._layers[i]);\n        }\n\n        this._priorityMarkers = [];\n        this._otherMarkers = [];\n        this._flushMarkersCache();\n        return this;\n    }\n});\n\n\nfunction isEmpty(obj) {\n    for (var prop in obj) {\n        if (obj.hasOwnProperty(prop)) {\n            return false;\n        }\n    }\n    return true;\n}\n\n/***/ }),\n/* 4 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n/* WEBPACK VAR INJECTION */(function(module) {var __WEBPACK_AMD_DEFINE_FACTORY__, __WEBPACK_AMD_DEFINE_ARRAY__, __WEBPACK_AMD_DEFINE_RESULT__;\n\nvar _typeof = typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\" ? function (obj) { return typeof obj; } : function (obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; };\n\n!function (r, e) {\n  \"object\" == ( false ? \"undefined\" : _typeof(exports)) && \"object\" == ( false ? \"undefined\" : _typeof(module)) ? module.exports = e() :  true ? !(__WEBPACK_AMD_DEFINE_ARRAY__ = [], __WEBPACK_AMD_DEFINE_FACTORY__ = (e),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ = (typeof __WEBPACK_AMD_DEFINE_FACTORY__ === 'function' ?\n\t\t\t\t(__WEBPACK_AMD_DEFINE_FACTORY__.apply(exports, __WEBPACK_AMD_DEFINE_ARRAY__)) : __WEBPACK_AMD_DEFINE_FACTORY__),\n\t\t\t\t__WEBPACK_AMD_DEFINE_RESULT__ !== undefined && (module.exports = __WEBPACK_AMD_DEFINE_RESULT__)) : \"object\" == (typeof exports === \"undefined\" ? \"undefined\" : _typeof(exports)) ? exports.General = e() : r.General = e();\n}(undefined, function () {\n  return function (r) {\n    function e(t) {\n      if (n[t]) return n[t].exports;var o = n[t] = { i: t, l: !1, exports: {} };return r[t].call(o.exports, o, o.exports, e), o.l = !0, o.exports;\n    }var n = {};return e.m = r, e.c = n, e.d = function (r, n, t) {\n      e.o(r, n) || Object.defineProperty(r, n, { configurable: !1, enumerable: !0, get: t });\n    }, e.n = function (r) {\n      var n = r && r.__esModule ? function () {\n        return r.default;\n      } : function () {\n        return r;\n      };return e.d(n, \"a\", n), n;\n    }, e.o = function (r, e) {\n      return Object.prototype.hasOwnProperty.call(r, e);\n    }, e.p = \"/dist/\", e(e.s = 1);\n  }([function (r, e, n) {\n    \"use strict\";\n    function t(r, e) {\n      for (var n = 0, t = 0; n < e.length; n++, t += a) {\n        var o = e[n],\n            u = o.iconIndex,\n            c = o.prevGroupIndex;r[t + i.pixelPositionX] = o.pixelPosition[0], r[t + i.pixelPositionY] = o.pixelPosition[1], r[t + i.groupIndex] = o.groupIndex, r[t + i.iconIndex] = void 0 !== u ? u : NaN, r[t + i.prevGroupIndex] = void 0 !== c ? c : NaN;\n      }\n    }function o(r, e) {\n      for (var n = 0, t = 0; n < r.length; n++, t += a) {\n        var o = e[t + i.iconIndex],\n            u = e[t + i.prevGroupIndex];r[n].iconIndex = o !== o ? void 0 : o, r[n].prevGroupIndex = u !== u ? void 0 : u;\n      }\n    }n.d(e, \"a\", function () {\n      return i;\n    }), n.d(e, \"c\", function () {\n      return a;\n    }), e.b = t, e.d = o;var i = { pixelPositionX: 0, pixelPositionY: 1, groupIndex: 2, iconIndex: 3, prevGroupIndex: 4 },\n        a = Object.keys(i).length;\n  }, function (r, e, n) {\n    \"use strict\";\n    Object.defineProperty(e, \"__esModule\", { value: !0 });var t = n(2);n.d(e, \"General\", function () {\n      return t.a;\n    });\n  }, function (r, e, n) {\n    \"use strict\";\n    n.d(e, \"a\", function () {\n      return a;\n    });var t = n(0),\n        o = n(3),\n        i = n.n(o),\n        a = function () {\n      function r() {\n        var r = this;this.worker = i()(4), this.queue = [], this.currentJob = void 0, this.markerArray = new Float32Array(1e3 * t.c), this.worker.onmessage = function (e) {\n          if (void 0 !== r.currentJob) {\n            var n = r.currentJob,\n                o = n.markers,\n                i = n.resolve;Object(t.d)(o, e.data), r.markerArray = e.data, r.currentJob = void 0, r.dequeue(), i();\n          }\n        };\n      }return r.prototype.generalize = function (r, e, n, t) {\n        var o = this,\n            i = { bounds: r, priorityGroups: e, sprites: n };return new Promise(function (r) {\n          o.queue.push({ message: i, markers: t, resolve: r }), o.dequeue();\n        });\n      }, r.prototype.clear = function () {\n        this.queue = [];\n      }, r.prototype.pack = function (r) {\n        r.length * t.c > this.markerArray.length && (this.markerArray = new Float32Array(r.length * t.c)), Object(t.b)(this.markerArray, r);\n      }, r.prototype.dequeue = function () {\n        if (void 0 === this.currentJob) {\n          var r = this.queue.shift();if (void 0 !== r) {\n            this.pack(r.markers);var e = r.message;e.markers = this.markerArray, e.markerCount = r.markers.length, this.worker.postMessage(e, [e.markers.buffer]), this.currentJob = r;\n          }\n        }\n      }, r;\n    }();\n  }, function (r, e, n) {\n    function t(r) {\n      function e(t) {\n        if (n[t]) return n[t].exports;var o = n[t] = { i: t, l: !1, exports: {} };return r[t].call(o.exports, o, o.exports, e), o.l = !0, o.exports;\n      }var n = {};e.m = r, e.c = n, e.i = function (r) {\n        return r;\n      }, e.d = function (r, n, t) {\n        e.o(r, n) || Object.defineProperty(r, n, { configurable: !1, enumerable: !0, get: t });\n      }, e.n = function (r) {\n        var n = r && r.__esModule ? function () {\n          return r.default;\n        } : function () {\n          return r;\n        };return e.d(n, \"a\", n), n;\n      }, e.o = function (r, e) {\n        return Object.prototype.hasOwnProperty.call(r, e);\n      }, e.p = \"/\", e.oe = function (r) {\n        throw console.error(r), r;\n      };var t = e(e.s = ENTRY_MODULE);return t.default || t;\n    }function o(r) {\n      return (r + \"\").replace(/[.?*+^$[\\]\\\\(){}|-]/g, \"\\\\$&\");\n    }function i(r) {\n      var e = [],\n          n = r.toString(),\n          t = n.match(/^function\\s?\\(\\w+,\\s*\\w+,\\s*(\\w+)\\)/);if (!t) return e;for (var i, a = t[1], u = new RegExp(\"(\\\\\\\\n|\\\\W)\" + o(a) + \"\\\\((/\\\\*.*?\\\\*/)?s?.*?([\\\\.|\\\\-|\\\\w|/|@]+).*?\\\\)\", \"g\"); i = u.exec(n);) {\n        e.push(i[3]);\n      }return e;\n    }function a(r, e) {\n      for (var n = [e], t = [], o = {}; n.length;) {\n        var a = n.pop();if (!o[a] && r[a]) {\n          o[a] = !0, t.push(a);var u = i(r[a]);n = n.concat(u);\n        }\n      }return t;\n    }r.exports = function (r, e) {\n      e = e || {};var o = n.m,\n          i = e.all ? Object.keys(o) : a(o, r),\n          u = \"(\" + t.toString().replace(\"ENTRY_MODULE\", JSON.stringify(r)) + \")({\" + i.map(function (r) {\n        return JSON.stringify(r) + \": \" + o[r].toString();\n      }).join(\",\") + \"})(self);\",\n          c = new window.Blob([u], { type: \"text/javascript\" });if (e.bare) return c;var s = window.URL || window.webkitURL || window.mozURL || window.msURL,\n          f = s.createObjectURL(c),\n          p = new window.Worker(f);return p.objectURL = f, p;\n    };\n  }, function (r, e, n) {\n    \"use strict\";\n    Object.defineProperty(e, \"__esModule\", { value: !0 });var t = n(5);e.default = function (r) {\n      r.onmessage = function (e) {\n        var n = e.data;Object(t.a)(n), r.postMessage(n.markers);\n      };\n    };\n  }, function (r, e, n) {\n    \"use strict\";\n    function t(r) {\n      for (var e = r.bounds, n = r.priorityGroups, t = r.sprites, m = r.markers, v = r.markerCount, l = 1 + (e.maxX - e.minX >> 3) << 3, x = e.maxY - e.minY, h = l * x + 8 >> 3, g = new Uint8Array(h), b = [], y = 0; y < n.length; y++) {\n        b[y] = new Uint8Array(h);\n      }for (var y = 0; y < v; y++) {\n        var w = y * s.c,\n            k = m[w + s.a.prevGroupIndex];if (!a(k)) {\n          var Y = m[w + s.a.pixelPositionX] - e.minX,\n              I = m[w + s.a.pixelPositionY] - e.minY,\n              X = n[k],\n              j = X.iconIndex,\n              O = X.margin,\n              P = X.degradation,\n              G = t[j];if (!G) continue;var A = G.size,\n              U = G.anchor;c(f, l, x, A, U, Y, I, 0), u(f) ? m[w + s.a.iconIndex] = -1 : m[w + s.a.iconIndex] = j, c(p, l, x, A, U, Y, I, O), u(p) || i(g, l, p), c(d, l, x, A, U, Y, I, P), u(d) || i(b[k], l, d);\n        }\n      }for (var y = 0; y < n.length; y++) {\n        var _ = n[y],\n            R = _.safeZone,\n            j = _.iconIndex,\n            O = _.margin,\n            P = _.degradation,\n            G = t[j];if (G) for (var A = G.size, U = G.anchor, J = 0 !== y ? b[y - 1] : void 0, L = y !== n.length - 1 ? b[y] : void 0, M = 0; M < v; M++) {\n          var w = M * s.c,\n              N = m[w + s.a.groupIndex],\n              k = m[w + s.a.prevGroupIndex],\n              Y = m[w + s.a.pixelPositionX] - e.minX,\n              I = m[w + s.a.pixelPositionY] - e.minY;N > y || !a(k) || (c(p, l, x, A, U, Y, I, O), u(p) || N === y && J && o(J, l, p) || (c(f, l, x, A, U, Y, I, R), u(f) || o(g, l, f) || (c(d, l, x, A, U, Y, I, P), i(g, l, p), L && i(L, l, d), m[w + s.a.iconIndex] = j, m[w + s.a.prevGroupIndex] = y)));\n        }\n      }\n    }function o(r, e, n) {\n      for (var t = n.minX, o = n.minY, i = n.maxX, a = n.maxY, u = o; u < a; u++) {\n        var c = u * e + t >> 3,\n            s = u * e + i >> 3,\n            f = 0;if (c === s) f = r[c] & 255 >> (7 & t) & 255 << 8 - (7 & i);else {\n          f = r[c] & 255 >> (7 & t);for (var p = c + 1; p < s; p++) {\n            f = r[p] | f;\n          }f = r[s] & 255 << 8 - (7 & i) | f;\n        }if (0 !== f) return !0;\n      }return !1;\n    }function i(r, e, n) {\n      for (var t = n.minX, o = n.minY, i = n.maxX, a = n.maxY, u = o; u < a; u++) {\n        var c = u * e + t >> 3,\n            s = u * e + i >> 3;if (c === s) r[c] = r[c] | 255 >> (7 & t) & 255 << 8 - (7 & i);else {\n          r[c] = r[c] | 255 >> (7 & t);for (var f = c + 1; f < s; f++) {\n            r[f] = 255;\n          }r[s] = r[s] | 255 << 8 - (7 & i);\n        }\n      }\n    }function a(r) {\n      return r !== r;\n    }function u(r) {\n      return r.minX === r.maxX || r.minY === r.maxY;\n    }function c(r, e, n, t, o, i, a, u) {\n      var c = i - t[0] * o[0] - u | 0,\n          s = a - t[1] * o[1] - u | 0,\n          f = i + t[0] * (1 - o[0]) + u | 0,\n          p = a + t[1] * (1 - o[1]) + u | 0;r.minX = c > 0 ? c < e ? c : e : 0, r.minY = s > 0 ? s < n ? s : n : 0, r.maxX = f > 0 ? f < e ? f : e : 0, r.maxY = p > 0 ? p < n ? p : n : 0;\n    }e.a = t;var s = n(0),\n        f = { minX: 0, minY: 0, maxX: 0, maxY: 0 },\n        p = { minX: 0, minY: 0, maxX: 0, maxY: 0 },\n        d = { minX: 0, minY: 0, maxX: 0, maxY: 0 };\n  }]);\n});\n//# sourceMappingURL=general.js.map\n/* WEBPACK VAR INJECTION */}.call(exports, __webpack_require__(5)(module)))\n\n/***/ }),\n/* 5 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = function (module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function () {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function get() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function get() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n\n/***/ }),\n/* 6 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nmodule.exports = __webpack_require__(7).default;\n\n/***/ }),\n/* 7 */\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = deepClone;\nexports.formatKeys = formatKeys;\nfunction deepClone(obj, format) {\n  var refs = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new Map();\n\n  var cloned = refs.get(obj);\n  if (cloned) return cloned;\n  if (Array.isArray(obj)) {\n    var _clone = [];\n    refs.set(obj, _clone);\n    for (var i = 0; i < obj.length; i++) {\n      _clone[i] = deepClone(obj[i], format, refs);\n    }\n    return _clone;\n  }\n  if (obj instanceof Date) return new Date(obj.valueOf());\n  if (!(obj instanceof Object)) return obj;\n  var clone = {};\n  refs.set(obj, clone);\n  var keys = Object.keys(obj);\n  for (var _i = 0; _i < keys.length; _i++) {\n    var key = format ? format(keys[_i]) : keys[_i];\n    clone[key] = deepClone(obj[keys[_i]], format, refs);\n  }\n  return clone;\n}\n\nfunction formatKeys(format) {\n  return function (obj) {\n    return deepClone(obj, format);\n  };\n}\n\ndeepClone.formatKeys = formatKeys;\n\n/***/ })\n/******/ ]);\n});\n\n\n// WEBPACK FOOTER //\n// generalize.min.js"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/dist/\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 401fa145d0d40168bb7e","import ExtendedMarker from './ExtendedMarker'; // Какого чОрта? @todo Вытащить в online, тут это не нужно\nimport MarkerGeneralizeGroup from './Generalize';\n\nexport default function extendLeaflet() {\n    L.markerEx = function(latlng, options) {\n        return new ExtendedMarker(latlng, options);\n    };\n\n    L.markerGeneralizeGroup = function(option) {\n        return new MarkerGeneralizeGroup(option);\n    };\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/index.js","import MarkerClassList from './MarkerClassList'; // eslint-disable-line no-unused-vars\n\n/**\n * Extended marker:\n * - has options to prevent deletion or hide during generalization\n * - makes use of internal class list being applied to icon node\n */\nexport default L.Marker.extend({\n    /**\n     * If we can use extended powers of current marker.\n     */\n    _extended: true,\n\n\n    /**\n     * Augment parent method to apply class names when icon is added on map\n     */\n    onAdd: function() {\n        L.Marker.prototype.onAdd.apply(this, arguments);\n\n        if (this._immunityLevel == this.IMMUNITY.NO_DELETE) {\n            this._icon.style.display = 'block';\n        }\n\n        this.classes._addClasses();\n    },\n\n    getEvents: function() {\n        this._zoomAnimated = false;\n        return L.Marker.prototype.getEvents.apply(this, arguments);\n    },\n\n    /**\n     * Determine removal possibility and hide marker if required.\n     * @returns {boolean} If marker should be removed from map\n     */\n    onBeforeRemove: function() {\n        if (this._immunityLevel == this.IMMUNITY.NO_HIDE) {\n            return false;\n        }\n\n        if (this._immunityLevel == this.IMMUNITY.NO_DELETE) {\n            this._icon.style.display = 'none';\n            return false;\n        }\n\n        return true;\n    },\n\n    initialize: function() {\n        L.Marker.prototype.initialize.apply(this, arguments);\n        this.classes = L.markerClassList(this);\n    },\n\n    /**\n     * Marker immunity mechanism\n     */\n    IMMUNITY: {\n        NONE: 0, // Simple marker\n        NO_DELETE: 1, // Will stay on map during generalization (DOM node of the icon will not be deleted).\n        NO_HIDE: 2 // Will not be neither deleted nor hidden during generalization.\n    },\n    _immunityLevel: null,\n    immunifyForDeletion: function() {\n        this._immunityLevel = this.IMMUNITY.NO_DELETE;\n        return this;\n    },\n    immunifyForHide: function() {\n        this._immunityLevel = this.IMMUNITY.NO_HIDE;\n        return this;\n    },\n    revokeImmunity: function() {\n        this._immunityLevel = this.IMMUNITY.NONE;\n        return this;\n    }\n});\n\n\n\n// WEBPACK FOOTER //\n// ./src/ExtendedMarker.js","/**\n * Icon internal classes mechanism\n * Adds possibility to assign css classes to icon even if it is not rendered (yet).\n * Classes will be assigned to icon when it is rendered.\n */\nL.MarkerClassList = function(marker) {\n    this._classList = {};\n    this._marker = marker;\n};\n\nL.Util.extend(L.MarkerClassList.prototype, {\n    add: function(className) {\n        this._classList[className] = 1;\n        if (this._marker._icon) {\n            L.DomUtil.addClass(this._marker._icon, className);\n        }\n        return this;\n    },\n    remove: function(className) {\n        delete this._classList[className];\n        if (this._marker._icon) {\n            L.DomUtil.removeClass(this._marker._icon, className);\n        }\n        return this;\n    },\n    contains: function(className) {\n        return !!this._classList[className];\n    },\n    clear: function() {\n        if (this._marker._icon) {\n            for (var className in this._classList) { // eslint-disable-line guard-for-in\n                L.DomUtil.removeClass(this._marker._icon, className);\n            }\n        }\n        this._classList = {};\n    },\n    toString: function() {\n        if (Object.keys) {\n            return Object.keys(this._classList).join(' ');\n        }\n        var classList = '';\n        for (var i in this._classList) { // eslint-disable-line guard-for-in\n            classList += i + ' ';\n        }\n        return classList;\n    },\n    _addClasses: function() {\n        if (!this._marker._icon) {\n            return;\n        }\n        for (var className in this._classList) { // eslint-disable-line guard-for-in\n            L.DomUtil.addClass(this._marker._icon, className);\n        }\n    }\n});\n\nL.markerClassList = function(marker) {\n    return new L.MarkerClassList(marker);\n};\n\nexport default L.MarkerClassList;\n\n\n\n// WEBPACK FOOTER //\n// ./src/MarkerClassList.js","import { General } from '@2gis/general';\nimport cloneDeep from 'deep-clone';\n\nexport default L.FeatureGroup.extend({\n    options: {\n        levels: [\n            {\n                margin: 30,\n                safeZone: 20,\n                size: [25, 40],\n                offset: [0.5, 1],\n                className: '_pin'\n            },\n            {\n                safeZone: 5,\n                size: [6, 6],\n                className: '_bullet'\n            },\n            {\n                safeZone: 0,\n                className: '_hidden'\n            }\n        ],\n\n        bufferPart: 0.5,\n\n        checkMarkerMinimumLevel: () => 0,\n\n        // by default Layer has overlayPane, but we work with markers\n        pane: 'markerPane'\n    },\n\n    initialize: function(options) {\n        L.Util.setOptions(this, options);\n\n        this._generalizer = new General();\n\n        this._layers = {};\n\n        this._priorityMarkers = [];\n        this._otherMarkers = [];\n\n        this.setMaxZoom(options.maxZoom);\n        this.setMinZoom(options.minZoom);\n\n        this._initZooms(); // Обязательно после set[Min|Max]Zoom\n    },\n\n    setMaxZoom: function(maxZoom) {\n        if (!isNaN(maxZoom) && maxZoom <= 19) {\n            this._maxZoom = maxZoom;\n        }\n    },\n\n    setMinZoom: function(minZoom) {\n        if (!isNaN(minZoom) && minZoom >= 0) {\n            if (minZoom > this._getMaxZoom()) {\n                throw new Error('Min zoom must be smaller than max zoom');\n            }\n            this._minZoom = minZoom;\n        }\n    },\n\n    _getMaxZoom: function() {\n        if (!isNaN(this._maxZoom)) {\n            return this._maxZoom;\n        }\n        if (this._map) {\n            return this._map.getMaxZoom();\n        }\n        return 18;\n    },\n\n    _getMinZoom: function() {\n        if (!isNaN(this._minZoom)) {\n            return this._minZoom;\n        }\n        if (this._map) {\n            return this._map.getMinZoom();\n        }\n        return 0;\n    },\n\n    _initZooms: function() {\n        this._zoomStat = {};\n        const maxZoom = this._getMaxZoom();\n        for (let i = this._getMinZoom(); i <= maxZoom; ++i) {\n            this._zoomStat[i] = {\n                ready: false,\n                pending: false,\n                markers: null,\n                bounds: { minX: 0, minY: 0, maxX: 0, maxY: 0 }\n            };\n        }\n    },\n\n    _flushMarkersCache() {\n        const maxZoom = this._getMaxZoom();\n        for (let i = this._getMinZoom(); i <= maxZoom; ++i) {\n            this._zoomStat[i].markers = null;\n        }\n    },\n\n    _getLevels: function(zoom) {\n        var ops = this.options;\n\n        var levels;\n        if (typeof ops.levels === 'function') {\n            levels = ops.levels(this._map, zoom);\n        } else {\n            levels = ops.levels;\n        }\n        return this._prepareLevels(cloneDeep(levels));\n    },\n\n    _prepareLevels: function(levels) {\n        const dpr = window.devicePixelRatio;\n        for (let levelId = 0; levelId < levels.length; levelId++) {\n            let level = levels[levelId];\n            level.index = levelId;\n\n            if (!level.size) {\n                level.size = [0, 0];\n            }\n            level.size[0] *= dpr;\n            level.size[1] *= dpr;\n\n            if (!level.offset) {\n                level.offset = [0.5, 0.5];\n            }\n\n            if (!level.margin) {\n                level.margin = 0;\n            }\n            level.margin *= dpr;\n\n            if (!level.safeZone) {\n                level.safeZone = 0;\n            }\n            level.safeZone *= dpr;\n\n            if (!level.degradation) {\n                level.degradation = 0;\n            }\n            level.degradation *= dpr;\n        }\n        return levels;\n    },\n\n    _addLayer: function(layer) {\n        layer.addEventParent(this);\n\n        if (layer.options && layer.options.showAlways) {\n            this._priorityMarkers.push(layer);\n        } else {\n            this._otherMarkers.push(layer);\n        }\n\n        var oldMap = this._map;\n\n        // Don't allow markers to be added to map: we'll do it during invalidation.\n        if (oldMap) {\n            this._map = null;\n        }\n        L.LayerGroup.prototype.addLayer.call(this, layer);\n        if (oldMap) {\n            this._map = oldMap;\n        }\n    },\n\n    /**\n     * Возвращает географические координаты центра карты на заданном зуме\n     * @param  {Number} zoom\n     * @return {L.LatLng}    Географический центр карты\n     */\n    _getMapCenter(zoom) {\n        const centerPoint = this._map._getCenterLayerPoint();\n        // @TODO getPixelOrigin должен зависить от зума, тут скрыт потенциальный баг\n        const projectedPoint = centerPoint.add(this._map.getPixelOrigin());\n        return this._map.unproject(projectedPoint, zoom);\n    },\n\n    /**\n     * Возвращает размеры экрана\n     */\n    _getScreenBounds(center, zoom) {\n        if (!this._map) {\n            return { minX: 0, minY: 0, maxX: 0, maxY: 0 };\n        }\n        const dpr = window.devicePixelRatio;\n        const topLeftPoint = this._map._getTopLeftPoint(center, zoom);\n        const size = this._map.getSize();\n        return {\n            minX: topLeftPoint.x * dpr,\n            minY: topLeftPoint.y * dpr,\n            maxX: (topLeftPoint.x + size.x) * dpr,\n            maxY: (topLeftPoint.y + size.y) * dpr\n        };\n    },\n\n    /**\n     * Возвращает размеры экрана с некоторым буффером вокруг\n     */\n    _getBounds: function(center, zoom) {\n        const screenBounds = this._getScreenBounds(center, zoom);\n        return {\n            minX: screenBounds.minX - (screenBounds.maxX - screenBounds.minX) * this.options.bufferPart,\n            minY: screenBounds.minY - (screenBounds.maxY - screenBounds.minY) * this.options.bufferPart,\n            maxX: screenBounds.maxX + (screenBounds.maxX - screenBounds.minX) * this.options.bufferPart,\n            maxY: screenBounds.maxY + (screenBounds.maxY - screenBounds.minY) * this.options.bufferPart\n        };\n    },\n\n    _getLatLngBounds: function(pointBound, center, zoom) {\n        const pixelBound = new L.Bounds(\n            L.point(pointBound.minX, pointBound.minY),\n            L.point(pointBound.maxX, pointBound.maxY)\n        );\n        const swCoord = this._map.unproject(pixelBound.getBottomLeft(), zoom);\n        const neCoord = this._map.unproject(pixelBound.getTopRight(), zoom);\n        return new L.LatLngBounds(swCoord, neCoord);\n    },\n\n    _prepareMarker: function(layer) {\n        const minZoom = this._getMinZoom();\n        for (let zoom = this._getMaxZoom(); zoom >= minZoom; --zoom) {\n            layer.options.classForZoom = layer.options.classForZoom || [];\n            layer.options.classForZoom[zoom] = 'HIDDEN';\n        }\n    },\n\n    _prepareMarkersForGeneralization: function(zoom) {\n        const dpr = window.devicePixelRatio;\n        if (this._zoomStat[zoom].markers) {\n            for (let i = 0; i < this._zoomStat[zoom].markers.length; ++i) {\n                const pixelPosition = this._map.project(this._zoomStat[zoom].markers[i]._latlng, zoom);\n                this._zoomStat[zoom].markers[i].pixelPosition = [pixelPosition.x * dpr, pixelPosition.y * dpr];\n            }\n            return this._zoomStat[zoom].markers;\n        }\n\n        const markers = new Array(this._otherMarkers.length);\n\n        for (let i = 0; i < this._otherMarkers.length; ++i) {\n            const pixelPosition = this._map.project(this._otherMarkers[i]._latlng, zoom);\n            const newMarker = {\n                _latlng: this._otherMarkers[i]._latlng,\n                groupIndex: this.options.checkMarkerMinimumLevel(this._otherMarkers[i]),\n                iconIndex: -1,\n                pixelPosition: [pixelPosition.x * dpr, pixelPosition.y * dpr]\n            };\n            markers[i] = newMarker;\n        }\n\n        return markers;\n    },\n\n    _calculateMarkersClassesIfNeeded: function(zoom = this._map.getZoom()) {\n        /**\n         * Возможны следующие варианты\n         * 1. Изменился zoom карты\n         * 1.1 Смотрим, для каких границ был произведена генерализация на этом зуме\n         * 1.2 Если попадаем в рамки границ, для которых уже произведена генерализация, то ничего не делаем\n         * 1.3 Если не попадаем - запускаем генерализацию\n         * 2. Изменился центр карты => изменились границы\n         * 2.1 Делаем шаги, аналогичные 1.1 - 1.3.\n         *\n         * Становится очевидно, что генерализацию нужно перезапускать\n         * только когда не попали в ранее посчитанные границы на заданном зуме.\n         */\n        if (!this._map) {\n            return;\n        }\n\n        if (!this._zoomStat[zoom].ready && !this._zoomStat[zoom].pending) {\n            this._calculateMarkersClasses(zoom);\n            return;\n        }\n\n        const center = this._getMapCenter();\n\n        const calculatedBounds = this._zoomStat[zoom].bounds; // Это \"старые\" границы, которые были генерализированы\n        const newBounds = this._getScreenBounds(center, zoom); // Именно размеры экрана без буффера\n        const newLatLngBounds = this._getLatLngBounds( // Это \"новые\" границы, которы должны быть перекрыты \"старыми\"\n            newBounds, center, zoom\n        );\n\n        if (!calculatedBounds.contains(newLatLngBounds)) { // Собственно, описанная выше проверка перекрытия границ\n            this._calculateMarkersClasses(zoom);\n            return;\n        }\n\n        // Если дошли сюда, это значит, что для заданного зума в рамках текущего баунда генерализация уже произведена.\n        this._invalidateMarkers();\n    },\n\n    _calculateMarkersClasses: function(zoom = this._map.getZoom()) {\n        if (!this._map) { // Если нет карты, то ничего полезного сделать мы не можем\n            return undefined;\n        }\n        if (isEmpty(this._layers)) { // Ничего не надо генерализовывать если маркеров нет\n            return undefined;\n        }\n        const levels = this._getLevels(zoom);\n        const center = this._getMapCenter();\n\n        // Набор конфигов для генерализации маркеров\n        const bounds = this._getBounds(center, zoom);\n        const priorityGroups = levels.map((level) => ({\n            iconIndex: level.index,\n            safeZone: level.safeZone,\n            margin: level.margin,\n            degradation: level.degradation\n        }));\n        const atlasSpritesEmulation = levels.map((level) => ({\n            size: level.size, // Размер иконки\n            anchor: level.offset // Центр иконки относительно ее размеров, принимает занчения от 0 до 1\n        }));\n\n        // Переводим маркеры в нужный формат\n        const markers = this._prepareMarkersForGeneralization(zoom);\n\n        this._zoomStat[zoom] = {\n            ready: false,\n            pending: true,\n            bounds: this._getLatLngBounds(bounds, center, zoom),\n            markers: markers\n        };\n\n        // Запускаем генерализацию\n        return this._generalizer.generalize(\n            bounds,\n            priorityGroups,\n            atlasSpritesEmulation,\n            markers\n        ).then(() => {\n            // Выставляем классы для генерализованных маркеров\n            for (let i = 0; i < markers.length; ++i) {\n                const marker = this._otherMarkers[i];\n                const iconIndex = markers[i].iconIndex;\n                marker.options.classForZoom[zoom] = iconIndex == -1 ? 'HIDDEN' : levels[iconIndex].className;\n            }\n\n            // Подбиваем маркера, которые не учавстовали в генерализации\n            for (let i = 0; i < this._priorityMarkers.length; ++i) {\n                const marker = this._priorityMarkers[i];\n                const iconIndex = this.options.checkMarkerMinimumLevel(marker);\n                marker.options.classForZoom[zoom] = iconIndex == -1 ? 'HIDDEN' : levels[iconIndex].className;\n            }\n\n            this._zoomStat[zoom].ready = true;\n            this._zoomStat[zoom].pending = false;\n            if (this._map.getZoom() == zoom) {\n                this._invalidateMarkers();\n            }\n        }).catch(() => {\n            this.fireEvent('generalizationError');\n        });\n    },\n\n    _invalidateMarkers: function() {\n        const zoom = this._map.getZoom();\n\n        if (!this._zoomStat[zoom].ready) {\n            return;\n        }\n\n        for (let i in this._layers) { // eslint-disable-line guard-for-in\n            const marker = this._layers[i];\n            const groupClass = marker.options.classForZoom[zoom];\n            const markerState = marker.options.state;\n\n            if (marker._immunityLevel) {\n                if (!marker._map) {\n                    this._map.addLayer(marker);\n                }\n\n                if (markerState != groupClass && groupClass != 'HIDDEN') {\n                    L.DomUtil.addClass(marker._icon, groupClass);\n                }\n            }\n\n            if (groupClass != 'HIDDEN' && markerState != groupClass) {\n                if (!marker._map) {\n                    this._map.addLayer(marker);\n                }\n\n                if (markerState != groupClass) {\n                    if (markerState && markerState != 'HIDDEN') {\n                        L.DomUtil.removeClass(marker._icon, markerState);\n                    }\n                    L.DomUtil.addClass(marker._icon, groupClass);\n                }\n            }\n\n            if (groupClass == 'HIDDEN') {\n                const shouldRemove = marker.onBeforeRemove ? marker.onBeforeRemove() : true;\n                if (shouldRemove) {\n                    this._map.removeLayer(marker);\n                }\n            }\n            marker.options.state = groupClass;\n        }\n\n        if (!isEmpty(this._layers)) {\n            this.getPane().style.display = 'block';\n        }\n        this.fireEvent('invalidationFinish');\n    },\n\n    _zoomStart: function() {\n        this._zoomStat[this._map.getZoom()] = {\n            ready: false,\n            pending: false,\n            bounds: this._map.getBounds(),\n            markers: null\n        };\n        if (!isEmpty(this._layers)) {\n            this.getPane().style.display = 'none';\n        }\n    },\n\n    addLayer: function(layer) {\n        this._addLayer(layer);\n        if (this._map && !layer._immunityLevel) {\n            this._flushMarkersCache();\n            this._prepareMarker(layer);\n            this._calculateMarkersClasses();\n            this._invalidateMarkers();\n        }\n        return this;\n    },\n\n    addLayers: function(layersArray) {\n        var i;\n        for (i = 0; i < layersArray.length; i++) {\n            this._addLayer(layersArray[i]);\n        }\n\n        if (this._map) {\n            this._flushMarkersCache();\n            this.eachLayer(this._prepareMarker, this);\n            setTimeout(this._calculateMarkersClasses.bind(this), 0);\n        }\n        return this;\n    },\n\n    _removeLayer: function(layer) {\n        var beforeLength = this._layers.length;\n        var index;\n        if ((index = this._priorityMarkers.indexOf(layer)) != -1) {\n            this._priorityMarkers.splice(index, 1);\n        } else if ((index = this._otherMarkers.indexOf(layer)) != -1) {\n            this._otherMarkers.splice(index, 1);\n        }\n        L.LayerGroup.prototype.removeLayer.call(this, layer);\n        return beforeLength - this._layers.length != 0;\n    },\n\n    removeLayer: function(layer) {\n        if (this._removeLayer(layer)) {\n            this._flushMarkersCache();\n            this._calculateMarkersClasses();\n            this._invalidateMarkers();\n        }\n\n        return this;\n    },\n\n    getEvents: function() {\n        var events = {\n            zoomstart: this._zoomStart,\n            zoomend: () => this._calculateMarkersClassesIfNeeded(),\n            moveend: () => this._calculateMarkersClassesIfNeeded()\n        };\n\n        return events;\n    },\n\n    onAdd: function(map) {\n        this._map = map;\n\n        this._initZooms();\n\n        if (this.getLayers().length) {\n\n            this.eachLayer(this._prepareMarker, this);\n            // wait user map manipulation to know correct init zoom\n            setTimeout(this._calculateMarkersClasses.bind(this), 0);\n        }\n    },\n\n    onRemove: function(map) {\n        if (!this._map) {\n            return;\n        }\n\n        L.LayerGroup.prototype.onRemove.call(this, map);\n\n        for (let i in this._layers) { // eslint-disable-line guard-for-in\n            const marker = this._layers[i];\n            marker.options.state = 'HIDDEN';\n        }\n\n        this._flushMarkersCache();\n        this._map = null;\n    },\n\n    clearLayers: function() {\n        for (let i in this._layers) { // eslint-disable-line guard-for-in\n            L.LayerGroup.prototype.removeLayer.call(this, this._layers[i]);\n        }\n\n        this._priorityMarkers = [];\n        this._otherMarkers = [];\n        this._flushMarkersCache();\n        return this;\n    }\n});\n\nfunction isEmpty(obj) {\n    for (var prop in obj) {\n        if (obj.hasOwnProperty(prop)) {\n            return false;\n        }\n    }\n    return true;\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/Generalize.js","!function(r,e){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=e():\"function\"==typeof define&&define.amd?define([],e):\"object\"==typeof exports?exports.General=e():r.General=e()}(this,function(){return function(r){function e(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return r[t].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};return e.m=r,e.c=n,e.d=function(r,n,t){e.o(r,n)||Object.defineProperty(r,n,{configurable:!1,enumerable:!0,get:t})},e.n=function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(n,\"a\",n),n},e.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},e.p=\"/dist/\",e(e.s=1)}([function(r,e,n){\"use strict\";function t(r,e){for(var n=0,t=0;n<e.length;n++,t+=a){var o=e[n],u=o.iconIndex,c=o.prevGroupIndex;r[t+i.pixelPositionX]=o.pixelPosition[0],r[t+i.pixelPositionY]=o.pixelPosition[1],r[t+i.groupIndex]=o.groupIndex,r[t+i.iconIndex]=void 0!==u?u:NaN,r[t+i.prevGroupIndex]=void 0!==c?c:NaN}}function o(r,e){for(var n=0,t=0;n<r.length;n++,t+=a){var o=e[t+i.iconIndex],u=e[t+i.prevGroupIndex];r[n].iconIndex=o!==o?void 0:o,r[n].prevGroupIndex=u!==u?void 0:u}}n.d(e,\"a\",function(){return i}),n.d(e,\"c\",function(){return a}),e.b=t,e.d=o;var i={pixelPositionX:0,pixelPositionY:1,groupIndex:2,iconIndex:3,prevGroupIndex:4},a=Object.keys(i).length},function(r,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var t=n(2);n.d(e,\"General\",function(){return t.a})},function(r,e,n){\"use strict\";n.d(e,\"a\",function(){return a});var t=n(0),o=n(3),i=n.n(o),a=function(){function r(){var r=this;this.worker=i()(4),this.queue=[],this.currentJob=void 0,this.markerArray=new Float32Array(1e3*t.c),this.worker.onmessage=function(e){if(void 0!==r.currentJob){var n=r.currentJob,o=n.markers,i=n.resolve;Object(t.d)(o,e.data),r.markerArray=e.data,r.currentJob=void 0,r.dequeue(),i()}}}return r.prototype.generalize=function(r,e,n,t){var o=this,i={bounds:r,priorityGroups:e,sprites:n};return new Promise(function(r){o.queue.push({message:i,markers:t,resolve:r}),o.dequeue()})},r.prototype.clear=function(){this.queue=[]},r.prototype.pack=function(r){r.length*t.c>this.markerArray.length&&(this.markerArray=new Float32Array(r.length*t.c)),Object(t.b)(this.markerArray,r)},r.prototype.dequeue=function(){if(void 0===this.currentJob){var r=this.queue.shift();if(void 0!==r){this.pack(r.markers);var e=r.message;e.markers=this.markerArray,e.markerCount=r.markers.length,this.worker.postMessage(e,[e.markers.buffer]),this.currentJob=r}}},r}()},function(r,e,n){function t(r){function e(t){if(n[t])return n[t].exports;var o=n[t]={i:t,l:!1,exports:{}};return r[t].call(o.exports,o,o.exports,e),o.l=!0,o.exports}var n={};e.m=r,e.c=n,e.i=function(r){return r},e.d=function(r,n,t){e.o(r,n)||Object.defineProperty(r,n,{configurable:!1,enumerable:!0,get:t})},e.n=function(r){var n=r&&r.__esModule?function(){return r.default}:function(){return r};return e.d(n,\"a\",n),n},e.o=function(r,e){return Object.prototype.hasOwnProperty.call(r,e)},e.p=\"/\",e.oe=function(r){throw console.error(r),r};var t=e(e.s=ENTRY_MODULE);return t.default||t}function o(r){return(r+\"\").replace(/[.?*+^$[\\]\\\\(){}|-]/g,\"\\\\$&\")}function i(r){var e=[],n=r.toString(),t=n.match(/^function\\s?\\(\\w+,\\s*\\w+,\\s*(\\w+)\\)/);if(!t)return e;for(var i,a=t[1],u=new RegExp(\"(\\\\\\\\n|\\\\W)\"+o(a)+\"\\\\((/\\\\*.*?\\\\*/)?s?.*?([\\\\.|\\\\-|\\\\w|/|@]+).*?\\\\)\",\"g\");i=u.exec(n);)e.push(i[3]);return e}function a(r,e){for(var n=[e],t=[],o={};n.length;){var a=n.pop();if(!o[a]&&r[a]){o[a]=!0,t.push(a);var u=i(r[a]);n=n.concat(u)}}return t}r.exports=function(r,e){e=e||{};var o=n.m,i=e.all?Object.keys(o):a(o,r),u=\"(\"+t.toString().replace(\"ENTRY_MODULE\",JSON.stringify(r))+\")({\"+i.map(function(r){return JSON.stringify(r)+\": \"+o[r].toString()}).join(\",\")+\"})(self);\",c=new window.Blob([u],{type:\"text/javascript\"});if(e.bare)return c;var s=window.URL||window.webkitURL||window.mozURL||window.msURL,f=s.createObjectURL(c),p=new window.Worker(f);return p.objectURL=f,p}},function(r,e,n){\"use strict\";Object.defineProperty(e,\"__esModule\",{value:!0});var t=n(5);e.default=function(r){r.onmessage=function(e){var n=e.data;Object(t.a)(n),r.postMessage(n.markers)}}},function(r,e,n){\"use strict\";function t(r){for(var e=r.bounds,n=r.priorityGroups,t=r.sprites,m=r.markers,v=r.markerCount,l=1+(e.maxX-e.minX>>3)<<3,x=e.maxY-e.minY,h=l*x+8>>3,g=new Uint8Array(h),b=[],y=0;y<n.length;y++)b[y]=new Uint8Array(h);for(var y=0;y<v;y++){var w=y*s.c,k=m[w+s.a.prevGroupIndex];if(!a(k)){var Y=m[w+s.a.pixelPositionX]-e.minX,I=m[w+s.a.pixelPositionY]-e.minY,X=n[k],j=X.iconIndex,O=X.margin,P=X.degradation,G=t[j];if(!G)continue;var A=G.size,U=G.anchor;c(f,l,x,A,U,Y,I,0),u(f)?m[w+s.a.iconIndex]=-1:m[w+s.a.iconIndex]=j,c(p,l,x,A,U,Y,I,O),u(p)||i(g,l,p),c(d,l,x,A,U,Y,I,P),u(d)||i(b[k],l,d)}}for(var y=0;y<n.length;y++){var _=n[y],R=_.safeZone,j=_.iconIndex,O=_.margin,P=_.degradation,G=t[j];if(G)for(var A=G.size,U=G.anchor,J=0!==y?b[y-1]:void 0,L=y!==n.length-1?b[y]:void 0,M=0;M<v;M++){var w=M*s.c,N=m[w+s.a.groupIndex],k=m[w+s.a.prevGroupIndex],Y=m[w+s.a.pixelPositionX]-e.minX,I=m[w+s.a.pixelPositionY]-e.minY;N>y||!a(k)||(c(p,l,x,A,U,Y,I,O),u(p)||N===y&&J&&o(J,l,p)||(c(f,l,x,A,U,Y,I,R),u(f)||o(g,l,f)||(c(d,l,x,A,U,Y,I,P),i(g,l,p),L&&i(L,l,d),m[w+s.a.iconIndex]=j,m[w+s.a.prevGroupIndex]=y)))}}}function o(r,e,n){for(var t=n.minX,o=n.minY,i=n.maxX,a=n.maxY,u=o;u<a;u++){var c=u*e+t>>3,s=u*e+i>>3,f=0;if(c===s)f=r[c]&255>>(7&t)&255<<8-(7&i);else{f=r[c]&255>>(7&t);for(var p=c+1;p<s;p++)f=r[p]|f;f=r[s]&255<<8-(7&i)|f}if(0!==f)return!0}return!1}function i(r,e,n){for(var t=n.minX,o=n.minY,i=n.maxX,a=n.maxY,u=o;u<a;u++){var c=u*e+t>>3,s=u*e+i>>3;if(c===s)r[c]=r[c]|255>>(7&t)&255<<8-(7&i);else{r[c]=r[c]|255>>(7&t);for(var f=c+1;f<s;f++)r[f]=255;r[s]=r[s]|255<<8-(7&i)}}}function a(r){return r!==r}function u(r){return r.minX===r.maxX||r.minY===r.maxY}function c(r,e,n,t,o,i,a,u){var c=i-t[0]*o[0]-u|0,s=a-t[1]*o[1]-u|0,f=i+t[0]*(1-o[0])+u|0,p=a+t[1]*(1-o[1])+u|0;r.minX=c>0?c<e?c:e:0,r.minY=s>0?s<n?s:n:0,r.maxX=f>0?f<e?f:e:0,r.maxY=p>0?p<n?p:n:0}e.a=t;var s=n(0),f={minX:0,minY:0,maxX:0,maxY:0},p={minX:0,minY:0,maxX:0,maxY:0},d={minX:0,minY:0,maxX:0,maxY:0}}])});\n//# sourceMappingURL=general.js.map\n\n\n// WEBPACK FOOTER //\n// ./node_modules/@2gis/general/dist/general.js","module.exports = function(module) {\r\n\tif(!module.webpackPolyfill) {\r\n\t\tmodule.deprecate = function() {};\r\n\t\tmodule.paths = [];\r\n\t\t// module.parent = undefined by default\r\n\t\tif(!module.children) module.children = [];\r\n\t\tObject.defineProperty(module, \"loaded\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.l;\r\n\t\t\t}\r\n\t\t});\r\n\t\tObject.defineProperty(module, \"id\", {\r\n\t\t\tenumerable: true,\r\n\t\t\tget: function() {\r\n\t\t\t\treturn module.i;\r\n\t\t\t}\r\n\t\t});\r\n\t\tmodule.webpackPolyfill = 1;\r\n\t}\r\n\treturn module;\r\n};\r\n\n\n\n// WEBPACK FOOTER //\n// (webpack)/buildin/module.js","module.exports = require('./lib').default\n\n\n\n// WEBPACK FOOTER //\n// ./node_modules/deep-clone/index.js","\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = deepClone;\nexports.formatKeys = formatKeys;\nfunction deepClone(obj, format) {\n  var refs = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : new Map();\n\n  var cloned = refs.get(obj);\n  if (cloned) return cloned;\n  if (Array.isArray(obj)) {\n    var _clone = [];\n    refs.set(obj, _clone);\n    for (var i = 0; i < obj.length; i++) {\n      _clone[i] = deepClone(obj[i], format, refs);\n    }\n    return _clone;\n  }\n  if (obj instanceof Date) return new Date(obj.valueOf());\n  if (!(obj instanceof Object)) return obj;\n  var clone = {};\n  refs.set(obj, clone);\n  var keys = Object.keys(obj);\n  for (var _i = 0; _i < keys.length; _i++) {\n    var key = format ? format(keys[_i]) : keys[_i];\n    clone[key] = deepClone(obj[keys[_i]], format, refs);\n  }\n  return clone;\n}\n\nfunction formatKeys(format) {\n  return function (obj) {\n    return deepClone(obj, format);\n  };\n}\n\ndeepClone.formatKeys = formatKeys;\n\n\n// WEBPACK FOOTER //\n// ./node_modules/deep-clone/lib/index.js"],"sourceRoot":""}